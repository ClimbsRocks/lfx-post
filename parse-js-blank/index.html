<!doctype html>
<head>
  <meta charset="utf-8">

  <title>feedByte</title>
  <meta name="description" content="feedByte">
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" type="text/css" href="../bower_components/bootstrap/dist/css/bootstrap.css">
  <link rel="stylesheet" type="text/css" href="../bower_components/bluebird/js/browser/bluebird.js">
  
  
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.3.3.min.js"></script>
  <script type="text/javascript" src="saveToDb.js"></script>
  <script type="text/javascript" src="getFromDb.js"></script>
  <script type="text/javascript" src="iterate.js"></script>
  <script type="text/javascript" src="loadDataAndStartEventListeners.js"></script>
</head>

<body>
  
  <div id="main">
    <table class="table table-bordered">
     <thead>
       <tr>
         <th>#</th>
         <th>User</th>
         <th>Content</th>
         <th>URL</th>
         <th>Dates</th>
         <th>Votes</th>
         <th>Upvote!</th>
       </tr>
     </thead>
     <tbody id="tableBody">
     </tbody>
   </table>
  </div>

  <script type="text/javascript">
  $(function() {
  
    Parse.initialize("oVtdba00w4uiXhxmlujQUM8iu5LJT5jbIvjnErcC", "v1l0JGIDfi0ZEFHWOVz7WIx88QfLTqHD4Ae5bgRK");


    var FeedByte = Parse.Object.extend("feedByte");
     
     //defines getData, which kicks off a string of promises
    var getData = function(className) {
      return new Promise(function(resolve, reject) {
        var query = new Parse.Query(className);
        resolve(query.find());
      });
    };

    //invokes getData with our Parse object
    getData(FeedByte).then(function(results) {
      var objects = [];
      //gathering the object attributes and id so we can uniquely identify this object later
      results.forEach(function(obj) {
        obj.attributes['parseID'] = obj.id;
        objects.push(obj.attributes);
      })
      return objects;
    //once we have our messages, iterate through them
    }).then(function(results) {
      iterate(results);
    })
    //once we've attached everything to the DOm, start our event listeners
    .then(function(results) {
      eventListeners()
    });

    var eventListeners = function() {
      $('button').on('click',function() {
        console.log('heard a click!', $(this));
      });
    }

  });

  </script>
</body>

</html>
